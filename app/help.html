<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Learn how to get started with Frogtab and explore Frogtab's features in detail">
    <title>Frogtab Help</title>
    <link rel="icon" href="/icon.svg" type="image/svg+xml" id="icon">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="stylesheet" href="https://cdn.simplecss.org/simple.min.css">
    <style>
      article {
        padding-top: 0;
        padding-bottom: 0;
      }
      .notice {
        display: none;
        padding-top: 1rem;
        padding-bottom: 1rem;
      }
      .notice.display {
        display: block;
      }
      .notice > div {
        display: none;
      }
      .notice > div.display {
        display: block;
      }
      .notice > div > p,
      .notice > div > div > input,
      .notice > div > div > button {
        margin: 0.5rem 0;
      }
      svg {
        vertical-align: text-top;
      }
      footer a {
        color: var(--text-light) !important;
      }
    </style>
  </head>
  <body>
    <header>
      <nav></nav>
      <h1>Frogtab Help</h1>
      <p>
        <a href="/" target="_blank">Frogtab</a> is a lightweight task manager that<br>
        helps you stay focused on today's priorities
      </p>
      <p>
        <a class="button" href="#getting-started">Get Started</a>
      </p>
    </header>
    <main>
      <p>
        Thanks for exploring Frogtab!
        To get in touch, please email <a href="mailto:feedback@frogtab.com">feedback@frogtab.com</a> üê∏
      </p>
      <article>
        <p>
          <strong>Learn how to use Frogtab</strong>
        </p>
        <ul>
          <li><a href="#getting-started">Getting started</a></li>
          <li><a href="#adding-tasks-to-your-inbox">Adding tasks to your inbox</a></li>
          <li><a href="#registering-for-a-personal-link">Registering for a personal link</a></li>
          <li><a href="#triaging-your-inbox">Triaging your inbox</a></li>
          <li><a href="#setting-up-recurring-tasks">Setting up recurring tasks</a></li>
          <li><a href="#keyboard-shortcuts">Keyboard shortcuts</a></li>
        </ul>
        <p>
          <strong>Learn about data privacy</strong>
        </p>
        <ul>
          <li><a href="#overview-of-data-privacy">Overview of data privacy</a></li>
          <li><a href="#privacy-implications-of-registering">Privacy implications of registering</a></li>
        </ul>
        <p>
          <strong>Manage your data</strong>
        <p>
        <ul>
          <li><a href="#exporting-your-data">Exporting your data</a></li>
          <li><a href="#importing-your-data">Importing your data</a></li>
        </ul>
      </article>
      <h2 id="getting-started">Getting started</h2>
      <p>
        <img alt="The Today view in Frogtab" src="/help-today.png" width="480">
      </p>
      <p>
        <strong>Today</strong> is your to-do list for today.
        Start the day by writing down everything you'd like to accomplish.
        As you complete your tasks, simply delete them.
      </p>
      <p>
        <strong>Inbox</strong> is where you can capture any thoughts or potential tasks that arise during the day.
        To learn more, see <a href="#adding-tasks-to-your-inbox">Adding tasks to your inbox</a>.
      </p>
      <p>
        You can triage your inbox later in the day.
        Frogtab displays a notification badge to remind you to triage your inbox as soon as it's convenient.
        As you triage your inbox, you'll remove or snooze each task.
        To learn more, see <a href="#triaging-your-inbox">Triaging your inbox</a>.
      </p>
      <p>
        At the beginning of each day, Frogtab automatically:
      </p>
      <ul>
        <li>Moves any remaining tasks from Today to your inbox</li>
        <li>Unsnoozes any snoozed tasks in your inbox</li>
        <li>Adds tasks from your <a href="#setting-up-recurring-tasks">weekly routine</a> to your inbox</li>
      </ul>
      <p>
        You can then triage your inbox and decide what you'd like to accomplish today.
      </p>
      <h2 id="adding-tasks-to-your-inbox">Adding tasks to your inbox</h2>
      <p>
        Frogtab makes it easy to capture any thoughts or potential tasks that arise as you're working through your priorities for the day.
        You don't need to fill in lots of information when you capture a task - you can add the task to your inbox without getting distracted.
      </p>
      <p>
        To add a task to your inbox, use either of the following methods:
      </p>
      <ul>
        <li>
          <p>
            Write down the task in your inbox.
          </p>
        </li>
        <li>
          <p>
            Open <a href="/send" target="_blank">Send to Frogtab</a> in a new tab, then write down the task and click the send button.
            This method is great if you want to capture the task without revealing your inbox (e.g., during a meeting).
          </p>
        </li>
      </ul>
      <p>
        By default, Send to Frogtab doesn't work from other devices.
        If you want to capture tasks from other devices, you must first register for a personal link.
      </p>
      <h2 id="registering-for-a-personal-link">Registering for a personal link</h2>
      <p>
        If you choose to register this device, you'll get a personal link that you can use to send tasks to Frogtab from any device.
      </p>
      <div class="notice display">
        <div id="case-checking" class="display">
          <p>
            Checking this device‚Ä¶
          </p>
        </div>
        <div id="case-unregistered">
          <p>
            You have not registered this device.
            To register this device, please share your experience of using Frogtab - thank you!
          </p>
          <div>
            <input id="comment" style="width: 100%" type="text" placeholder="Your experience‚Ä¶">
          </div>
          <div>
            <button id="register" disabled>Send &amp; Register</button>
          </div>
          <p>
            <a href="#privacy-implications-of-registering">Learn about data privacy</a>
          </p>
        </div>
        <div id="case-registering">
          <p>
            Registering this device‚Ä¶
          </p>
        </div>
        <div id="case-registered">
          <p>
            You have registered this device.
          </p>
          <div>
            <button id="link">Open My Personal Link</button>
          </div>
          <p>
            <a href="#privacy-implications-of-registering">Learn about data privacy</a>
          </p>
        </div>
      </div>
      <p>
        If this device is registered, you'll see a cloud icon at the top of Frogtab.
        The cloud icon means that Frogtab is ready to receive tasks from your personal link.
      </p>
      <p>
        More details about your personal link:
      </p>
      <ul>
        <li>
          <p>
            Anyone who knows your personal link can send tasks to your inbox.
          </p>
        </li>
        <li>
          <p>
            Tasks may take up to 10 minutes to appear in your inbox.
            To force Frogtab to check for new tasks, refresh Frogtab.
          </p>
        </li>
        <li>
          <p>
            If you clear your browsing data, your personal link will stop working.
            To reactivate your personal link, <a href="#importing-your-data">import your Frogtab data</a>
            (assuming that you have previously <a href="#exporting-your-data">made a backup</a>).
            Or you can re-register this device and get a new personal link.
          </p>
        </li>
      </ul>
      <h2 id="triaging-your-inbox">Triaging your inbox</h2>
      <p>
        The purpose of triaging your inbox is to make a decision about how to act on each of the tasks that you've captured.
      </p>
      <p>
        To triage your inbox, take one of the following actions for each task in your inbox:
      </p>
      <ul>
        <li>
          <p>
            Complete the task immediately, then delete it.
          </p>
        </li>
        <li>
          <p>
            Move the task to Today if you plan to work on it later the same day.
          </p>
        </li>
        <li>
          <p>
            Snooze the task by writing # in front of the task. For example:
          </p>
          <p>
            <img alt="The Inbox view in Frogtab" src="/help-inbox.png" width="480">
          </p>
          <p>
            Frogtab will unsnooze the task at the beginning of the next day.
          </p>
        </li>
        <li>
          <p>
            Move the task to a more appropriate location outside Frogtab (e.g., a calendar event or a topic in a meeting agenda).
          </p>
        </li>
        <li>
          <p>
            Delete the task if it's not particularly important.
          </p>
        </li>
      </ul>
      <p>
        As soon as your inbox is empty or only contains snoozed tasks, the notification badge disappears.
      </p>
      <h2 id="setting-up-recurring-tasks">Setting up recurring tasks</h2>
      <p>
        If there are tasks that you usually do on the same day each week, Frogtab can automatically add the tasks to your inbox at the beginning of the appropriate day.
      </p>
      <p>
        To set up recurring tasks:
      </p>
      <ol>
        <li>
          <p>
            Open <a href="/week" target="_blank">Weekly Routine</a> in a new tab.
          </p>
        </li>
        <li>
          <p>
            Select a day, then write down the tasks that you usually do on that day.
          </p>
        </li>
      </ol>
      <p>
        After you've finished writing down your tasks, close the tab.
      </p>
      <h2 id="keyboard-shortcuts">Keyboard shortcuts</h2>
      <table style="width: 100%">
        <thead>
          <tr>
            <th style="width: 40%">Action</th>
            <th style="width: 30%">macOS</th>
            <th style="width: 30%">Windows and Linux</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Select Today</td>
            <td><kbd>‚åò + U</kbd></td>
            <td><kbd>Ctrl + U</kbd></td>
          </tr>
          <tr>
            <td>Select Inbox</td>
            <td><kbd>‚åò + I</kbd></td>
            <td><kbd>Ctrl + I</kbd></td>
          </tr>
          <tr>
            <td>Start a new line at the top</td>
            <td><kbd>‚åò + Enter</kbd></td>
            <td><kbd>Ctrl + Enter</kbd></td>
          </tr>
        </tbody>
      </table>
      <p>
        For <a href="/send" target="_blank">Send to Frogtab</a>:
      </p>
      <table style="width: 100%">
        <thead>
          <tr>
            <th style="width: 40%">Action</th>
            <th style="width: 30%">macOS</th>
            <th style="width: 30%">Windows and Linux</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Send</td>
            <td><kbd>‚åò + Enter</kbd></td>
            <td><kbd>Ctrl + Enter</kbd></td>
          </tr>
        </tbody>
      </table>
      <h2 id="overview-of-data-privacy">Overview of data privacy</h2>
      <p>
        Frogtab stores the following data that you create:
      </p>
      <ul>
        <li>The contents of Today and Inbox</li>
        <li>Recurring tasks from your weekly routine</li>
      </ul>
      <p>
        Your data is stored in your browser and is not sent to a server.
        If you like, you can make a backup of your data.
        To learn more, see <a href="#exporting-your-data">Exporting your data</a>.
      </p>
      <p>
        If you choose to register this device, you'll get a personal link that you can use to send tasks to Frogtab from any device.
        To learn more, see <a href="#registering-for-a-personal-link">Registering for a personal link</a> and <a href="#privacy-implications-of-registering">Privacy implications of registering</a>.
      </p>
      <h2 id="exporting-your-data">Exporting your data</h2>
      <p>
        Your data is stored in your browser.
        If you like, you can make a backup of your data by exporting your data in JSON format.
      </p>
      <p>
        To export your data, click
        <svg width="20px" height="20px" stroke-width="1.5" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" color="currentColor"><path d="M3 5h18M3 12h18M3 19h18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>
        at the bottom of Frogtab, then choose <strong>Export My Data</strong>.
      </p>
      <p>
        Some browsers are able to directly write to files on your device.
        If your browser supports this feature, Frogtab can automatically back up your data whenever your data changes.
        To start automatically backing up your data, click <strong>Enable Auto-Backup</strong> at the bottom of Frogtab.
      </p>
      <h2 id="importing-your-data">Importing your data</h2>
      <p>
        If you have previously made a backup of your data, you can restore your data.
      </p>
      <p>
        To start the restore process, <a href="#" id="start-restore">pick a backup file</a>.
      </p>
      <input type="file" id="choose-backup-file" style="display: none;" accept=".json">
      <div id="staged-restore" class="notice">
        <div class="display">
          <p>
            Refresh Frogtab to restore your data from <strong id="restore-date"></strong>.
          </p>
          <div>
            <button id="cancel-restore">Don't Restore My Data</button>
          </div>
        </div>
      </div>
      <h2 id="privacy-implications-of-registering">Privacy implications of registering</h2>
      <p>
        If you choose to register this device, Frogtab generates identification and encryption credentials for this device. The credentials are stored in your browser and are included if you make a backup of your data.
      </p>
      <p>
        The credentials are also stored on a server, with the exception of a private key that Frogtab uses to decrypt tasks received from your personal link.
      </p>
      <p>
        More details about how your personal link works:
      </p>
      <ul>
        <li>
          <p>
            When you use your personal link to send a task to Frogtab, the task is first encrypted on the sending device.
            The encrypted task is then sent to the server.
          </p>
        </li>
        <li>
          <p>
            Only this device is permitted to download the encrypted task from the server.
            After downloading the encrypted task, Frogtab decrypts the task using a private key that never leaves this device.
          </p>
        </li>
        <li>
          <p>
            The server deletes the encrypted task as soon as it has been downloaded.
          </p>
        </li>
      </ul>
      <p>
        For technical details, see <a href="https://github.com/dwilding/frogtab#data-flow" target="_blank">Data flow</a> in GitHub.
      </p>
    </main>
    <footer>
      <p>
        Frogtab is a free app developed by <a href="https://github.com/dwilding" target="_blank">Dave Wilding</a>.
        It's designed to be stable over many years and inexpensive for me to operate. 
        I hope that Frogtab brings joy to your day!
      </p>
      <p>
        Acknowledgments:
        <a href="https://simplecss.org" target="_blank">Simple.css</a>,
        <a href="https://openpgpjs.org" target="_blank">OpenPGP.js</a>,
        <a href="https://uuid.ramsey.dev" target="_blank">ramsey/uuid</a>,
        <a href="https://iconoir.com" target="_blank">iconnoir</a>,
        <a href="https://www.fiverr.com/mackwhyte" target="_blank">mackwhyte</a>
      </p>
    </footer>
    <script>
      function delayForUX(f) {
        return Promise.all([
          f(),
          new Promise(resolve => setTimeout(resolve, 1500))
        ]);
      }
      function tryToStageRestore(backupJSON) {
        let backupData;
        try {
          backupData = JSON.parse(backupJSON);
        }
        catch (err) {
          return;
        }
        if (!("date" in backupData)) {
          return;
        }
        localStorage.setItem("restore", backupJSON);
        setRestoreStatus(backupData);
      }
      function setRestoreStatus(backupData) {
        const backupDate = (new Date(backupData.date)).toLocaleDateString(undefined, {
          day: "numeric",
          month: "long",
          year: "numeric"
        });
        dom.stagedRestore.classList.add("display");
        dom.restoreDate.textContent = backupDate;
        dom.cancelRestore.addEventListener("click", event => {
          localStorage.removeItem("restore");
          dom.stagedRestore.classList.remove("display");
        });
      }
      async function register() {
        dom.caseUnregistered.classList.remove("display");
        dom.caseRegistering.classList.add("display");
        await delayForUX(async () => {
          await sdk.register(dom.comment.value.trim());
        });
        localStorage.setItem("user.apiKey", sdk.inboxOwner.apiKey);
        localStorage.setItem("user.pgpPrivateKey", sdk.inboxOwner.pgpPrivateKey);
        localStorage.setItem("user.pgpPublicKey", sdk.publicInbox.pgpPublicKey);
        localStorage.setItem("user.userID", sdk.publicInbox.userID);
        dom.caseRegistering.classList.remove("display");
        dom.caseRegistered.classList.add("display");
        dom.link.addEventListener("click", event => {
          window.open(`/send#${sdk.publicInbox.userID}`, "_blank");
        });
      }
      async function startApp() {
        if (localStorage.getItem("restore") !== null) {
          setRestoreStatus(JSON.parse(localStorage.getItem("restore")));
        }
        dom.startRestore.addEventListener("click", event => {
          event.preventDefault();
          dom.chooseBackupFile.click();
        });
        dom.chooseBackupFile.addEventListener("change", event => {
          const backupFile = dom.chooseBackupFile.files[0];
          if (backupFile === undefined) {
            return;
          }
          const backupFileReader = new FileReader();
          backupFileReader.onload = event => {
            tryToStageRestore(backupFileReader.result);
          };
          backupFileReader.readAsText(backupFile);
          dom.chooseBackupFile.value = "";
        });
        window.addEventListener("storage", event => {
          if (
            (
              dom.stagedRestore.classList.contains("display")
              && localStorage.getItem("restore") === null
            )
            || (
              !dom.stagedRestore.classList.contains("display")
              && localStorage.getItem("restore") !== null
            )
          ) {
            location.reload();
          }
        });
        let hasPublicInbox;
        await delayForUX(async () => {
          sdk = await import("/open/sdk.js");
          hasPublicInbox = (
            localStorage.getItem("user.userID") !== null
            && await sdk.setPublicInbox(localStorage.getItem("user.userID"))
          );
        });
        dom.caseChecking.classList.remove("display");
        if (hasPublicInbox) {
          dom.caseRegistered.classList.add("display");
          dom.link.addEventListener("click", event => {
            window.open(`/send#${localStorage.getItem("user.userID")}`, "_blank");
          });
        }
        else {
          dom.caseUnregistered.classList.add("display");
          dom.comment.addEventListener("input", event => {
            const comment = dom.comment.value.trim();
            dom.register.disabled = (comment == "");
          });
          dom.register.addEventListener("click", event => {
            register();
          });
          dom.comment.addEventListener("keydown", event => {
            if (!dom.register.disabled && event.key.toLowerCase() == "enter") {
              register();
            }
          });
        }
      }

      // ******** Initial setup ********
      const dom = {
        caseChecking: document.getElementById("case-checking"),
        caseUnregistered: document.getElementById("case-unregistered"),
        caseRegistering: document.getElementById("case-registering"),
        caseRegistered: document.getElementById("case-registered"),
        comment: document.getElementById("comment"),
        register: document.getElementById("register"),
        link: document.getElementById("link"),
        startRestore: document.getElementById("start-restore"),
        chooseBackupFile: document.getElementById("choose-backup-file"),
        stagedRestore: document.getElementById("staged-restore"),
        restoreDate: document.getElementById("restore-date"),
        cancelRestore: document.getElementById("cancel-restore")
      };
      let sdk;
      startApp();
    </script>
  </body>
</html>
